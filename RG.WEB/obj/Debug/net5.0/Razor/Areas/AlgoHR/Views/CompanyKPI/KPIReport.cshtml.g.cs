#pragma checksum "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "9d4cbb23bb26541af6c04275b63261ca8bf63aa6"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(AspNetCore.Areas_AlgoHR_Views_CompanyKPI_KPIReport), @"mvc.1.0.view", @"/Areas/AlgoHR/Views/CompanyKPI/KPIReport.cshtml")]
namespace AspNetCore
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.AspNetCore.Mvc.Rendering;
    using Microsoft.AspNetCore.Mvc.ViewFeatures;
#nullable restore
#line 1 "E:\TFS Project\RG_ERP\RG.WEB\Areas\_ViewImports.cshtml"
using RG.WEB;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "E:\TFS Project\RG_ERP\RG.WEB\Areas\_ViewImports.cshtml"
using RG.WEB.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "E:\TFS Project\RG_ERP\RG.WEB\Areas\_ViewImports.cshtml"
using RG.Application.IdentityEntities;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "E:\TFS Project\RG_ERP\RG.WEB\Areas\_ViewImports.cshtml"
using Microsoft.AspNetCore.Identity;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "E:\TFS Project\RG_ERP\RG.WEB\Areas\_ViewImports.cshtml"
using System.Security.Claims;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "E:\TFS Project\RG_ERP\RG.WEB\Areas\_ViewImports.cshtml"
using RG.Application.Constants;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "E:\TFS Project\RG_ERP\RG.WEB\Areas\_ViewImports.cshtml"
using RG.Application.Common.Utilities;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "E:\TFS Project\RG_ERP\RG.WEB\Areas\_ViewImports.cshtml"
using RG.Application.Contracts;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "E:\TFS Project\RG_ERP\RG.WEB\Areas\_ViewImports.cshtml"
using Microsoft.AspNetCore.Antiforgery;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "E:\TFS Project\RG_ERP\RG.WEB\Areas\_ViewImports.cshtml"
using Microsoft.AspNetCore.Http;

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"9d4cbb23bb26541af6c04275b63261ca8bf63aa6", @"/Areas/AlgoHR/Views/CompanyKPI/KPIReport.cshtml")]
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"579f12fddde6ad7d5e2e7207f508f2b104c1f8c2", @"/Areas/_ViewImports.cshtml")]
    public class Areas_AlgoHR_Views_CompanyKPI_KPIReport : global::Microsoft.AspNetCore.Mvc.Razor.RazorPage<List<RG.Application.Contracts.AlgoHR.Setups.CompanyKPIParticularss.Queries.RequestResponseModel.CompanyKPIReportRM>>
    {
        private static readonly global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute __tagHelperAttribute_0 = new global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute("href", new global::Microsoft.AspNetCore.Html.HtmlString("~/AdminLTE-3.1.0/plugins/jquery-ui/jquery-ui.min.css"), global::Microsoft.AspNetCore.Razor.TagHelpers.HtmlAttributeValueStyle.DoubleQuotes);
        private static readonly global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute __tagHelperAttribute_1 = new global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute("rel", new global::Microsoft.AspNetCore.Html.HtmlString("stylesheet"), global::Microsoft.AspNetCore.Razor.TagHelpers.HtmlAttributeValueStyle.DoubleQuotes);
        private static readonly global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute __tagHelperAttribute_2 = new global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute("href", new global::Microsoft.AspNetCore.Html.HtmlString("~/lib/bootstrap-5.0.2/css/bootstrap.min.css"), global::Microsoft.AspNetCore.Razor.TagHelpers.HtmlAttributeValueStyle.DoubleQuotes);
        private static readonly global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute __tagHelperAttribute_3 = new global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute("src", new global::Microsoft.AspNetCore.Html.HtmlString("~/AdminLTE-3.1.0/plugins/jquery/jquery.min.js"), global::Microsoft.AspNetCore.Razor.TagHelpers.HtmlAttributeValueStyle.DoubleQuotes);
        private static readonly global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute __tagHelperAttribute_4 = new global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute("src", new global::Microsoft.AspNetCore.Html.HtmlString("~/AdminLTE-3.1.0/plugins/jquery-ui/jquery-ui.min.js"), global::Microsoft.AspNetCore.Razor.TagHelpers.HtmlAttributeValueStyle.DoubleQuotes);
        private static readonly global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute __tagHelperAttribute_5 = new global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute("src", new global::Microsoft.AspNetCore.Html.HtmlString("~/lib/bootstrap-5.0.2/js/bootstrap.bundle.min.js"), global::Microsoft.AspNetCore.Razor.TagHelpers.HtmlAttributeValueStyle.DoubleQuotes);
        #line hidden
        #pragma warning disable 0649
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext __tagHelperExecutionContext;
        #pragma warning restore 0649
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner __tagHelperRunner = new global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner();
        #pragma warning disable 0169
        private string __tagHelperStringValueBuffer;
        #pragma warning restore 0169
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager __backed__tagHelperScopeManager = null;
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager __tagHelperScopeManager
        {
            get
            {
                if (__backed__tagHelperScopeManager == null)
                {
                    __backed__tagHelperScopeManager = new global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager(StartTagHelperWritingScope, EndTagHelperWritingScope);
                }
                return __backed__tagHelperScopeManager;
            }
        }
        private global::Microsoft.AspNetCore.Mvc.Razor.TagHelpers.HeadTagHelper __Microsoft_AspNetCore_Mvc_Razor_TagHelpers_HeadTagHelper;
        private global::Microsoft.AspNetCore.Mvc.Razor.TagHelpers.UrlResolutionTagHelper __Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper;
        private global::Microsoft.AspNetCore.Mvc.Razor.TagHelpers.BodyTagHelper __Microsoft_AspNetCore_Mvc_Razor_TagHelpers_BodyTagHelper;
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
#nullable restore
#line 2 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
  
    ViewData[PageInfo.PageTitle] = "Company KPI Report";
    ViewData[PageInfo.PageHeader] = "Company KPI Report";
    Layout = null;
    decimal conversionRate = Model.First().ConversionRate;
    var kpiMonthYear = Model.Where(x => x.KPIMonthName != "").Select(x => new
    {
        x.KPIMonth,
        x.KPIYear,
        x.KPIMonthName
    }).Distinct().OrderBy(x => x.KPIYear).ThenBy(x => x.KPIMonth);

    var particulars = Model.Select(x => new
    {
        x.ParticularHead,
        x.Particulars,
        x.Serial,
        x.ID,
        x.DecimalUpTo
    }).Distinct().OrderBy(x => x.Serial).ThenBy(x => x.ID);


#line default
#line hidden
#nullable disable
            WriteLiteral("    <!DOCTYPE html>\r\n    <html>\r\n    ");
            __tagHelperExecutionContext = __tagHelperScopeManager.Begin("head", global::Microsoft.AspNetCore.Razor.TagHelpers.TagMode.StartTagAndEndTag, "9d4cbb23bb26541af6c04275b63261ca8bf63aa67995", async() => {
                WriteLiteral("\r\n        <title>KPI Report</title>\r\n        ");
                __tagHelperExecutionContext = __tagHelperScopeManager.Begin("link", global::Microsoft.AspNetCore.Razor.TagHelpers.TagMode.SelfClosing, "9d4cbb23bb26541af6c04275b63261ca8bf63aa68298", async() => {
                }
                );
                __Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.Razor.TagHelpers.UrlResolutionTagHelper>();
                __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper);
                __tagHelperExecutionContext.AddHtmlAttribute(__tagHelperAttribute_0);
                __tagHelperExecutionContext.AddHtmlAttribute(__tagHelperAttribute_1);
                await __tagHelperRunner.RunAsync(__tagHelperExecutionContext);
                if (!__tagHelperExecutionContext.Output.IsContentModified)
                {
                    await __tagHelperExecutionContext.SetOutputContentAsync();
                }
                Write(__tagHelperExecutionContext.Output);
                __tagHelperExecutionContext = __tagHelperScopeManager.End();
                WriteLiteral("\r\n        ");
                __tagHelperExecutionContext = __tagHelperScopeManager.Begin("link", global::Microsoft.AspNetCore.Razor.TagHelpers.TagMode.SelfClosing, "9d4cbb23bb26541af6c04275b63261ca8bf63aa69480", async() => {
                }
                );
                __Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.Razor.TagHelpers.UrlResolutionTagHelper>();
                __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper);
                __tagHelperExecutionContext.AddHtmlAttribute(__tagHelperAttribute_2);
                __tagHelperExecutionContext.AddHtmlAttribute(__tagHelperAttribute_1);
                await __tagHelperRunner.RunAsync(__tagHelperExecutionContext);
                if (!__tagHelperExecutionContext.Output.IsContentModified)
                {
                    await __tagHelperExecutionContext.SetOutputContentAsync();
                }
                Write(__tagHelperExecutionContext.Output);
                __tagHelperExecutionContext = __tagHelperScopeManager.End();
                WriteLiteral("\r\n        ");
                __tagHelperExecutionContext = __tagHelperScopeManager.Begin("script", global::Microsoft.AspNetCore.Razor.TagHelpers.TagMode.StartTagAndEndTag, "9d4cbb23bb26541af6c04275b63261ca8bf63aa610662", async() => {
                }
                );
                __Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.Razor.TagHelpers.UrlResolutionTagHelper>();
                __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper);
                __tagHelperExecutionContext.AddHtmlAttribute(__tagHelperAttribute_3);
                await __tagHelperRunner.RunAsync(__tagHelperExecutionContext);
                if (!__tagHelperExecutionContext.Output.IsContentModified)
                {
                    await __tagHelperExecutionContext.SetOutputContentAsync();
                }
                Write(__tagHelperExecutionContext.Output);
                __tagHelperExecutionContext = __tagHelperScopeManager.End();
                WriteLiteral("\r\n        ");
                __tagHelperExecutionContext = __tagHelperScopeManager.Begin("script", global::Microsoft.AspNetCore.Razor.TagHelpers.TagMode.StartTagAndEndTag, "9d4cbb23bb26541af6c04275b63261ca8bf63aa611766", async() => {
                }
                );
                __Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.Razor.TagHelpers.UrlResolutionTagHelper>();
                __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper);
                __tagHelperExecutionContext.AddHtmlAttribute(__tagHelperAttribute_4);
                await __tagHelperRunner.RunAsync(__tagHelperExecutionContext);
                if (!__tagHelperExecutionContext.Output.IsContentModified)
                {
                    await __tagHelperExecutionContext.SetOutputContentAsync();
                }
                Write(__tagHelperExecutionContext.Output);
                __tagHelperExecutionContext = __tagHelperScopeManager.End();
                WriteLiteral("\r\n        ");
                __tagHelperExecutionContext = __tagHelperScopeManager.Begin("script", global::Microsoft.AspNetCore.Razor.TagHelpers.TagMode.StartTagAndEndTag, "9d4cbb23bb26541af6c04275b63261ca8bf63aa612870", async() => {
                }
                );
                __Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.Razor.TagHelpers.UrlResolutionTagHelper>();
                __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper);
                __tagHelperExecutionContext.AddHtmlAttribute(__tagHelperAttribute_5);
                await __tagHelperRunner.RunAsync(__tagHelperExecutionContext);
                if (!__tagHelperExecutionContext.Output.IsContentModified)
                {
                    await __tagHelperExecutionContext.SetOutputContentAsync();
                }
                Write(__tagHelperExecutionContext.Output);
                __tagHelperExecutionContext = __tagHelperScopeManager.End();
                WriteLiteral(@"


        <link rel=""stylesheet"" href=""https://cdn.datatables.net/1.10.12/css/jquery.dataTables.min.css"" />
        <link rel=""stylesheet"" href=""https://cdn.datatables.net/buttons/1.2.2/css/buttons.dataTables.min.css"" />
        <script type=""text/javascript"" src=""https://code.jquery.com/jquery-1.12.3.js""></script>
        <script type=""text/javascript"" src=""https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js""></script>
        <script type=""text/javascript"" src=""https://cdn.datatables.net/buttons/1.2.2/js/dataTables.buttons.min.js""></script>
        <script type=""text/javascript"" src=""https://cdnjs.cloudflare.com/ajax/libs/jszip/2.5.0/jszip.min.js""></script>
        <script type=""text/javascript"" src=""https://cdn.rawgit.com/bpampuch/pdfmake/0.1.18/build/pdfmake.min.js""></script>
        <script type=""text/javascript"" src=""https://cdn.rawgit.com/bpampuch/pdfmake/0.1.18/build/vfs_fonts.js""></script>
        <script type=""text/javascript"" src=""https://cdn.datatables.net/buttons/1.2.2/js/b");
                WriteLiteral("uttons.html5.min.js\"></script>\r\n\r\n        <style>\r\n            .header {\r\n                position: sticky;\r\n                top: 0;\r\n            }\r\n        </style>\r\n\r\n    ");
            }
            );
            __Microsoft_AspNetCore_Mvc_Razor_TagHelpers_HeadTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.Razor.TagHelpers.HeadTagHelper>();
            __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_Razor_TagHelpers_HeadTagHelper);
            await __tagHelperRunner.RunAsync(__tagHelperExecutionContext);
            if (!__tagHelperExecutionContext.Output.IsContentModified)
            {
                await __tagHelperExecutionContext.SetOutputContentAsync();
            }
            Write(__tagHelperExecutionContext.Output);
            __tagHelperExecutionContext = __tagHelperScopeManager.End();
            WriteLiteral("\r\n    ");
            __tagHelperExecutionContext = __tagHelperScopeManager.Begin("body", global::Microsoft.AspNetCore.Razor.TagHelpers.TagMode.StartTagAndEndTag, "9d4cbb23bb26541af6c04275b63261ca8bf63aa615961", async() => {
                WriteLiteral(@"
        <div class=""row"">
            <div class=""col-md-12 col-sm-12 col-lg-12"">
                <table class=""table table-sm table-bordered table-striped text-sm"" style=""font-size:11px;"">
                    <thead class=""bg-dark text-white"">
                        <tr><td");
                BeginWriteAttribute("colspan", " colspan=\"", 5965, "\"", 6002, 1);
#nullable restore
#line 134 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
WriteAttributeValue("", 5975, kpiMonthYear.Count() + 1, 5975, 27, false);

#line default
#line hidden
#nullable disable
                EndWriteAttribute();
                WriteLiteral(" class=\"fw-bold\" style=\"font-size:14px;\">Robintex Group</td></tr>\r\n                        <tr>\r\n                            <td>KPI of</td>\r\n");
#nullable restore
#line 137 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                              

                                foreach (var item in kpiMonthYear)
                                {

#line default
#line hidden
#nullable disable
                WriteLiteral("                                    <td class=\"fw-bold\">");
#nullable restore
#line 141 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                                                    Write($"{item.KPIMonthName}, {item.KPIYear}");

#line default
#line hidden
#nullable disable
                WriteLiteral("</td>\r\n");
#nullable restore
#line 142 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                                }
                            

#line default
#line hidden
#nullable disable
                WriteLiteral("                        </tr>\r\n                        <tr class=\"bg-danger text-center\"><td");
                BeginWriteAttribute("colspan", " colspan=\"", 6544, "\"", 6581, 1);
#nullable restore
#line 145 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
WriteAttributeValue("", 6554, kpiMonthYear.Count() + 1, 6554, 27, false);

#line default
#line hidden
#nullable disable
                EndWriteAttribute();
                WriteLiteral(" class=\"fw-bold\">Conversion Rate($): ");
#nullable restore
#line 145 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                                                                                                                                   Write(conversionRate);

#line default
#line hidden
#nullable disable
                WriteLiteral("</td></tr>\r\n                    </thead>\r\n                    <tbody>\r\n");
#nullable restore
#line 148 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                          
                            var prevParticularHead = "";

                            

#line default
#line hidden
#nullable disable
#nullable restore
#line 151 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                             foreach (var item in particulars)
                            {
                                if (prevParticularHead != item.ParticularHead)
                                {
                                    if (item.ParticularHead == item.Particulars)
                                    {
                                        string rowColor = "";
                                        if (item.ID == 16)
                                        {
                                            rowColor = "bg-success fw-bold fst-italic";
                                        }
                                        else if (item.ID == 17)
                                        {
                                            rowColor = "bg-info fw-bolder fst-italic";
                                        }

#line default
#line hidden
#nullable disable
                WriteLiteral("                                        <tr");
                BeginWriteAttribute("class", " class=\"", 7704, "\"", 7721, 1);
#nullable restore
#line 166 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
WriteAttributeValue("", 7712, rowColor, 7712, 9, false);

#line default
#line hidden
#nullable disable
                EndWriteAttribute();
                WriteLiteral(">\r\n                                            <td class=\"col-sm-2 col-md-2\">");
#nullable restore
#line 167 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                                                                      Write($"{item.Serial}. {item.Particulars}");

#line default
#line hidden
#nullable disable
                WriteLiteral("</td>\r\n");
#nullable restore
#line 168 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                                             foreach (var itemMonthYear in kpiMonthYear)
                                            {
                                                var decimalUpTo = "{" + $"0:n{item.DecimalUpTo}" + "}";
                                                decimal particularValue = 0;

                                                if (item.ID == 5)
                                                {
                                                    particularValue = ProducedMinOverall(itemMonthYear.KPIMonth, itemMonthYear.KPIYear);
                                                }
                                                //else if (item.ID == 11)
                                                //{
                                                //    particularValue = InputMinOverall(itemMonthYear.KPIMonth, itemMonthYear.KPIYear);
                                                //}
                                                else if (item.ID == 12)
                                                {
                                                    particularValue = CMWithOutDepreciation(itemMonthYear.KPIMonth, itemMonthYear.KPIYear);
                                                }
                                                else if (item.ID == 13)
                                                {
                                                    particularValue = CMWithDepreciation(itemMonthYear.KPIMonth, itemMonthYear.KPIYear);
                                                }
                                                else if (item.ID == 14)
                                                {
                                                    particularValue = CMWithOutDepreciation(itemMonthYear.KPIMonth, itemMonthYear.KPIYear)/conversionRate;
                                                }
                                                else if (item.ID == 15)
                                                {
                                                    particularValue = CMWithDepreciation(itemMonthYear.KPIMonth, itemMonthYear.KPIYear) / conversionRate;
                                                }
                                                else if (item.ID == 16)
                                                {
                                                    particularValue = CPMWithDepreciation(itemMonthYear.KPIMonth, itemMonthYear.KPIYear);
                                                }
                                                else if (item.ID == 17)
                                                {
                                                    particularValue = CPMWithDepreciation(itemMonthYear.KPIMonth, itemMonthYear.KPIYear) / conversionRate;
                                                }
                                                else
                                                {
                                                    var particular = Model.Where(x => x.ID == item.ID && x.KPIMonth == itemMonthYear.KPIMonth && x.KPIYear == itemMonthYear.KPIYear).FirstOrDefault();
                                                    if (particular != null)
                                                    {
                                                        particularValue = particular.ParticularValue.Value;
                                                    }
                                                }

#line default
#line hidden
#nullable disable
                WriteLiteral("                                                <td>");
#nullable restore
#line 213 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                                               Write(String.Format(decimalUpTo, particularValue));

#line default
#line hidden
#nullable disable
                WriteLiteral("</td>\r\n");
#nullable restore
#line 214 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                                            }

#line default
#line hidden
#nullable disable
                WriteLiteral("                                        </tr>\r\n");
#nullable restore
#line 216 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                                    }
                                    else
                                    {

#line default
#line hidden
#nullable disable
                WriteLiteral("                                        <tr>\r\n                                            <td class=\"col-sm-2 col-md-2 fw-bold\">");
#nullable restore
#line 220 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                                                                              Write($"{item.Serial}. {item.ParticularHead}");

#line default
#line hidden
#nullable disable
                WriteLiteral("</td>\r\n");
#nullable restore
#line 222 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                                             foreach (var itemMonthYear in kpiMonthYear)
                                            {
                                                var decimalUpTo = "{" + $"0:n{item.DecimalUpTo}" + "}";
                                                decimal particularValue = 0;
                                                if (item.ID == 2)
                                                {
                                                    List<int> selectedParticulars = new() { 2, 3 };
                                                    particularValue = AddParticulars(selectedParticulars, itemMonthYear.KPIMonth, itemMonthYear.KPIYear);
                                                }
                                                if (item.ID == 4)
                                                {
                                                    List<int> selectedParticulars = new() { 4 };
                                                    particularValue = AddParticulars(selectedParticulars, itemMonthYear.KPIMonth, itemMonthYear.KPIYear);
                                                }
                                                if (item.ID == 7)
                                                {
                                                    List<int> selectedParticulars = new() { 7, 8 };
                                                    particularValue = AddParticulars(selectedParticulars, itemMonthYear.KPIMonth, itemMonthYear.KPIYear);
                                                }
                                                if (item.ID == 9)
                                                {
                                                    particularValue = EfficiencyOverall(itemMonthYear.KPIMonth, itemMonthYear.KPIYear);
                                                }
                                                if (item.ID == 18)
                                                {
                                                    List<int> selectedParticulars = new() { 18,19,20,21};
                                                    particularValue = AddParticulars(selectedParticulars, itemMonthYear.KPIMonth, itemMonthYear.KPIYear);
                                                }
                                                if (item.ID == 22)
                                                {
                                                    List<int> selectedParticulars = new() { 22, 23 };
                                                    particularValue = AddParticulars(selectedParticulars, itemMonthYear.KPIMonth, itemMonthYear.KPIYear);
                                                }

#line default
#line hidden
#nullable disable
                WriteLiteral("                                                <td class=\"fw-bold\">");
#nullable restore
#line 255 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                                                               Write(String.Format(decimalUpTo, particularValue));

#line default
#line hidden
#nullable disable
                WriteLiteral("</td>\r\n");
#nullable restore
#line 256 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                                            }

#line default
#line hidden
#nullable disable
                WriteLiteral("                                        </tr>\r\n                                        <tr>\r\n                                            <td class=\"col-sm-2 col-md-2\">&nbsp;&nbsp;&nbsp;&nbsp; ");
#nullable restore
#line 259 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                                                                                               Write($"{item.Particulars}");

#line default
#line hidden
#nullable disable
                WriteLiteral("</td>\r\n");
#nullable restore
#line 260 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                                             foreach (var itemMonthYear in kpiMonthYear)
                                            {
                                                decimal particularValue = 0;
                                                var particular = Model.Where(x => x.ID == item.ID && x.KPIMonth == itemMonthYear.KPIMonth && x.KPIYear == itemMonthYear.KPIYear).FirstOrDefault();
                                                if (particular != null)
                                                {
                                                    particularValue = particular.ParticularValue.Value;
                                                }
                                                var decimalUpTo = "{" + $"0:n{item.DecimalUpTo}" + "}";

#line default
#line hidden
#nullable disable
                WriteLiteral("                                                <td>");
#nullable restore
#line 269 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                                               Write(String.Format(decimalUpTo, particularValue));

#line default
#line hidden
#nullable disable
                WriteLiteral("</td>\r\n");
#nullable restore
#line 270 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                                            }

#line default
#line hidden
#nullable disable
                WriteLiteral("                                        </tr>\r\n");
#nullable restore
#line 272 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                                    }
                                }
                                else
                                {

#line default
#line hidden
#nullable disable
                WriteLiteral("                                    <tr>\r\n                                        <td class=\"col-sm-2 col-md-2\">&nbsp;&nbsp;&nbsp;&nbsp; ");
#nullable restore
#line 277 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                                                                                           Write($"{item.Particulars}");

#line default
#line hidden
#nullable disable
                WriteLiteral("</td>\r\n");
#nullable restore
#line 278 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                                         foreach (var itemMonthYear in kpiMonthYear)
                                        {
                                            var decimalUpTo = "{" + $"0:n{item.DecimalUpTo}" + "}";
                                            decimal particularValue = 0;


                                            var particular = Model.Where(x => x.ID == item.ID && x.KPIMonth == itemMonthYear.KPIMonth && x.KPIYear == itemMonthYear.KPIYear).FirstOrDefault();
                                            if (particular != null)
                                            {
                                                particularValue = particular.ParticularValue.Value;
                                            }


#line default
#line hidden
#nullable disable
                WriteLiteral("                                            <td>");
#nullable restore
#line 290 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                                           Write(String.Format(decimalUpTo, particularValue));

#line default
#line hidden
#nullable disable
                WriteLiteral("</td>\r\n");
#nullable restore
#line 291 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                                        }

#line default
#line hidden
#nullable disable
                WriteLiteral("                                    </tr>\r\n");
#nullable restore
#line 293 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                                }
                                prevParticularHead = item.ParticularHead;
                            }

#line default
#line hidden
#nullable disable
                WriteLiteral("                    </tbody>\r\n                    <tfoot>\r\n                        <tr class=\"fw-bold\">\r\n                            <td>Grand Total</td>\r\n");
#nullable restore
#line 301 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                             foreach (var itemMonthYear in kpiMonthYear)
                            {
                                decimal particularValue = 0;
                                particularValue = GrandTotal(itemMonthYear.KPIMonth, itemMonthYear.KPIYear);

#line default
#line hidden
#nullable disable
                WriteLiteral("                                <td>");
#nullable restore
#line 305 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                                Write(String.Format("{0:n3}", particularValue));

#line default
#line hidden
#nullable disable
                WriteLiteral("</td>\r\n");
#nullable restore
#line 306 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
                            }

#line default
#line hidden
#nullable disable
                WriteLiteral("                        </tr>\r\n                    </tfoot>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    ");
            }
            );
            __Microsoft_AspNetCore_Mvc_Razor_TagHelpers_BodyTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.Razor.TagHelpers.BodyTagHelper>();
            __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_Razor_TagHelpers_BodyTagHelper);
            await __tagHelperRunner.RunAsync(__tagHelperExecutionContext);
            if (!__tagHelperExecutionContext.Output.IsContentModified)
            {
                await __tagHelperExecutionContext.SetOutputContentAsync();
            }
            Write(__tagHelperExecutionContext.Output);
            __tagHelperExecutionContext = __tagHelperScopeManager.End();
            WriteLiteral("\r\n</html>\r\n");
        }
        #pragma warning restore 1998
#nullable restore
#line 24 "E:\TFS Project\RG_ERP\RG.WEB\Areas\AlgoHR\Views\CompanyKPI\KPIReport.cshtml"
           
    decimal AddParticulars(List<int> selectedParticulars, int month, int year)
    {
        var returnValue = Model.Where(x => x.KPIMonth == month && x.KPIYear == year && selectedParticulars.Contains(x.ID)).Sum(x => x.ParticularValue);
        return returnValue == null ? 0 : returnValue.Value;
    }
    decimal ProducedMinOverall(int month, int year)
    {
        List<int> selectedParticulars = new() { 7, 8 };
        var totalProducedPcs = Model.Where(x => x.KPIMonth == month && x.KPIYear == year && selectedParticulars.Contains(x.ID)).Sum(x => x.ParticularValue);
        var smvParticular = Model.Where(x => x.KPIMonth == month && x.KPIYear == year && x.ID == 6).FirstOrDefault();
        if (totalProducedPcs != null && smvParticular != null)
        {
            return totalProducedPcs.Value * smvParticular.ParticularValue.Value;
        }
        else
        {
            return 0;
        }
    }
    decimal InputMinOverall(int month, int year)
    {
        /*
        decimal valueMultiplied = 1;
        List<int> selectedParticulars = new() { 1, 4 };
        Model.Where(x => x.KPIMonth == month && x.KPIYear == year && selectedParticulars.Contains(x.ID))
            .ToList().ForEach(x => { valueMultiplied *= x.ParticularValue != null ? x.ParticularValue.Value : 1; });

        return valueMultiplied * 10 * 60;
        */
        //Total Data is fullfiled by IE Department
        var minOverall = Model.Where(b => b.ID == 11).FirstOrDefault();
        if (minOverall != null)
        {
            return minOverall.ParticularValue??1;
        }
        return 1;
    }
    decimal EfficiencyOverall(int month, int year)
    {
        List<int> selectedParticulars = new() { 9 };
        return AddParticulars(selectedParticulars, month, year);
        //var prodMin = ProducedMinOverall(month, year);
        //var inputMin = InputMinOverall(month, year);
        //return prodMin / inputMin;
    }
    decimal GrandTotal(int month, int year)
    {
        List<int> selectedParticulars = new() { 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31 };
        return AddParticulars(selectedParticulars, month, year);
    }
    decimal CMWithDepreciation(int month, int year)
    {
        var grandTotal = GrandTotal(month, year);
        var producedMin = ProducedMinOverall(month, year);
        return producedMin>0? grandTotal / producedMin:0;
    }
    decimal CMWithOutDepreciation(int month, int year)
    {
        decimal dep = 0;
        var cmWithDep = CMWithDepreciation(month, year);
        var depParticular = Model.Where(x => x.KPIMonth == month && x.KPIYear == year && x.ID == 30).FirstOrDefault();
        if (depParticular != null)
        {
            dep = depParticular.ParticularValue.Value;
        }
        var producedMin = ProducedMinOverall(month, year);
        return producedMin > 0 ? cmWithDep - (dep / producedMin):0;
    }
    decimal CPMWithDepreciation(int month, int year)
    {
        var grandTotal = GrandTotal(month, year);
        var inputMin = InputMinOverall(month, year);
        return grandTotal / inputMin;
    }

#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<List<RG.Application.Contracts.AlgoHR.Setups.CompanyKPIParticularss.Queries.RequestResponseModel.CompanyKPIReportRM>> Html { get; private set; }
    }
}
#pragma warning restore 1591
